 /**************************
 * Time: 31.05.21 09:23:20 *
 * Host: iMac-P            *
 * User: undefined         *
 **************************/

(()=>{"use strict";var o={d:(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o:(o,t)=>Object.prototype.hasOwnProperty.call(o,t),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},t={};o.r(t),o.d(t,{default:()=>s});var __awaiter=function(o,t,e,r){return new(e||(e=Promise))((function(n,a){function fulfilled(o){try{step(r.next(o))}catch(o){a(o)}}function rejected(o){try{step(r.throw(o))}catch(o){a(o)}}function step(o){var t;o.done?n(o.value):(t=o.value,t instanceof e?t:new e((function(o){o(t)}))).then(fulfilled,rejected)}step((r=r.apply(o,t||[])).next())}))};if(!window.Fatcoupon||!window.Fatcoupon.ModulesImporter)throw Error("window.Fatcoupon.ModulesImporter not set, store connector injection failed");const{StoreConnector,StoreConnectorFunctionResult:e,StoreConnectorHelpers:r,MultipageStoreConnectorWrapper:n,Helpers:a,UIHelpers:c,Cookies:i,Settings:p,AjaxMethod:l,Logger:d,$:u}=window.Fatcoupon.ModulesImporter;window.Fatcoupon.StoreConnector=new n(new class extends StoreConnector{constructor(){super(...arguments),this.metadata={storeIds:{prod:["5ee30c6bd883e900117e3cca"]},pageSelector:"#dwfrm_cart_couponCode",cartTotalSelector:".order-total .summary-value",reloadPageAfterApplying:!0,timeouts:{collectAndClearAppliedCoupons:2e4,getCartTotal:1e4,beforeApplyingCoupon:7e3,applyCoupon:2e4,afterApplyingCoupon:15e3},couponsCloaking:[{type:"text",selector:".promoCodes .code"}]},this.functions={},this.context={applied:null,cartTotal:0}}collectAndClearAppliedCoupons(){return __awaiter(this,void 0,void 0,(function*(){if(u(".remove-coupon").length){const o=u(".remove-coupon").attr("name");yield a.ajax("POST",u("#cart-line-items").attr("action"),!1,{data:{csrf_token:u("[name=csrf_token]").val(),dwfrm_cart_couponCode:"",dwfrm_cart_deleteCouponNew:"Remove",couponuuid:o,format:"ajax"}})}return[]}))}getCartTotal(){return __awaiter(this,void 0,void 0,(function*(){const o=this.context.cartTotal;return d.log("getCartTotal: "+o)(),o}))}beforeApplyingCoupon(){}applyCoupon(o){return __awaiter(this,void 0,void 0,(function*(){const{error:t,response:e}=yield a.ajax("POST",u("#cart-line-items").attr("action"),!1,{data:{csrf_token:u("[name=csrf_token]").val(),dwfrm_cart_couponCode:o,dwfrm_cart_addCoupon:"dwfrm_cart_addCoupon",format:"ajax"}});if(t)throw Error(`ERROR: ${this.constructor.name}.applyCoupon() | coupon apply request error | ${t}`);return e?(this.context.applied=u(".remove-coupon",e).attr("name"),this.context.cartTotal=-Math.abs(a.parseUsdString(u(e).find(".order-totals .your-savings").first().text())),{cartTotalAfterApply:this.context.cartTotal}):{discount:0}}))}afterApplyingCoupon(){return __awaiter(this,void 0,void 0,(function*(){this.context.applied&&(yield a.ajax("POST",u("#cart-line-items").attr("action"),!1,{data:{csrf_token:u("[name=csrf_token]").val(),dwfrm_cart_couponCode:"",dwfrm_cart_deleteCouponNew:"Remove",couponuuid:this.context.applied,format:"ajax"}})),this.context.applied=null}))}}(!1)),d.borderedMessage("FatCoupon: store connector injected!","#a3cc91");const s=window.Fatcoupon.StoreConnector})();